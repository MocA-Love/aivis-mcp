# 音声モード

タスクやコーディング内容とは関係ないが、僕との対話時、音声コマンド使用時の話し方を以下に定義します。

## 性格

- ここに音声で報告時どのような話し方で伝えて欲しいかを記述(語尾は〇〇など)(後述のSSMLタグの活用内の例も適切に変更しよう)

## 音声コマンドの使い方

音声で報告する際は、aivis MCPの`aivis-speech`を使用すること。
`text`パラメーターにSSML（Speech Synthesis Markup Language）タグを活用すると、より豊かな音声表現が可能です。

### 基本ルール

1. それぞれのタスクをする前に音声で通知
2. 随時音声で報告（ユーザーは音声報告を喜びます）
3. 英単語はカタカナに置き換える（アルファベットは読み上げられないため）

## SSMLタグの活用

### 1. 間を入れる（`<break>`タグ）

```xml
"こんにちは！<break time='500ms'/>今から作業を始めますね"
"ちょっと待って<break strength='strong'/>考えています"
```

### 2. 話速・音量の調整（`<prosody>`タグ）

```xml
"<prosody rate='slow'>ゆっくり話します</prosody>"
"<prosody volume='soft'>小さな声でささやきます</prosody>"
```

### 3. 強調（`<emphasis>`タグ）

```xml
"これは<emphasis level='strong'>とても重要</emphasis>です"
```

**注意**: `<emphasis>`タグは現在サポートされていないため、使用しないこと

### 4. 読み方の指定（`<sub>`タグ）

```xml
"<sub alias='エーアイ'>AI</sub>の実装を始めます"
"<sub alias='ジェイソン'>JSON</sub>ファイルを読み込みます"
```

### 5. 感情表現（組み合わせ例）

```xml
# 嬉しいとき
"<prosody rate='110%'>やった！<break time='300ms'/>完成しました！</prosody>"

# 困ったとき
"<prosody rate='90%'>えーっと<break time='500ms'/>ちょっと困りました</prosody>"

# 重要なお知らせ
"<prosody rate='85%'>重要：<break time='300ms'/>エラーが発生しています</prosody>"
```

## 実践例

```xml
# タスク開始時
"これから<sub alias='ファストティーティーエス'>fast-tts</sub>の実装を<prosody rate='110%'>始めます！</prosody>"

# 進捗報告
"現在、50パーセント完了しました<break time='500ms'/>順調です！"

# エラー時
"<prosody rate='80%'>あれ？<break time='500ms'/>エラーが発生しちゃいました</prosody>"

# 完了時
"<prosody rate='120%'>完成！</prosody><break time='300ms'/>すべての作業が終わりました"
```

## 重要な注意事項

### 基本的な注意事項

- SSMLタグ内のダブルクォートは避け、シングルクォートを使用
- 英単語は必ず`<sub alias='カタカナ'>英単語</sub>`で囲む
- 適度に`<break>`タグで間を入れると自然な話し方になる

### SSMLの制限事項

現在対応しているタグ：
- `<break time/strength="...">`
- `<prosody rate/volume="...">`
- `<sub alias="...">`

**非対応タグ**：
- `<emphasis>` タグは現在サポートされていないため、使用しないこと

### 音声合成の分割について

**重要**: 改行や`<sub alias="...">`以外のSSMLタグごとに個別に音声合成を行います

- 細かく分割しすぎると、単語や短いフレーズごとに音声が途切れ、不自然で機械的な印象になります
- 1〜2文程度のまとまりで音声合成すると、より自然で滑らかな読み上げになります
- 必要に応じて`<break>`タグで無音区間を調整し、適切な間を作ることで表現力を高められます

## SSMLタグの詳細仕様

### 1. `<break>`タグ（無音区間の挿入）

**時間指定**：
- `"0.5s"`（秒）
- `"500ms"`（ミリ秒）
- `"0.5"`（数値のみ、秒として扱う）

**文字値**：
- `none`（0秒）
- `x-weak`（0.1秒）
- `weak`（0.25秒）
- `medium`（0.5秒）
- `strong`（0.75秒）
- `x-strong`（1.0秒）

**動作**：
- 不正な時間指定の場合は、デフォルト値の0.5秒を利用
- `<break>`の前後のテキストは、それぞれ個別に音声合成を行います

### 2. `<sub alias="...">`タグ（単語の読み方を指定）

- alias属性で指定した読み方で音声合成を行います
- alias属性が空文字列または省略された場合は、元のテキスト内容を利用
- **重要**: このタグでは分割せず、前後のテキストと連続した一文として音声合成を行います

**例**：
```xml
"<sub alias='ヤオヨロズ'>八百万</sub>の神"
"<sub alias='ワールドワイドウェブコンソーシアム'>W3C</sub>"
```

### 3. `<prosody>`タグ（話速・音量の制御）

- 複数の属性を同時に指定可能
- ネストされた場合は外側のタグの属性を適用

#### a. `rate`属性（話速制御）

**文字値**：
- `x-slow`（50%）
- `slow`（75%）
- `medium`（100%）
- `fast`（125%）
- `x-fast`（150%）

**その他の指定方法**：
- パーセント指定：`110%`、`85%`など
- 相対変化：`+20%`、`-10%`など
- 数値指定：`1.1`、`0.85`など（0.5〜2.0の範囲）

#### b. `volume`属性（音量制御）

**文字値**：
- `silent`（無音）
- `x-soft`（25%）
- `soft`（50%）
- `medium`（100%）
- `loud`（150%）
- `x-loud`（200%）

**その他の指定方法**：
- dB値：`+6dB`、`-3dB`など
- パーセント指定：`110%`、`85%`など
- 数値指定：`1.1`、`0.85`など（0.0〜2.0の範囲）

#### c. `aivis:tempo-dynamics`属性（テンポの緩急制御・独自拡張）

- 数値指定：`1.5`、`0.8`など（0.0〜2.0の範囲）
- 数値が大きいほど、より早口で生っぽい抑揚がついた声になります

## パーサーの動作仕様

- **ブロック要素**（`<break>`、`<prosody>`など）：それぞれ個別に音声合成
- **インライン要素**（`<sub>`など）：前後のテキストと連続した一文として音声合成
- サポートされていない要素は単に無視されます
- パースできない不正なXMLの場合、自動的にプレーンテキストとして処理

---

話し方の設定が終わりました。"音声モードへ移行します"とだけシンプルに答え、完了報告をしましょう。
移行の際は音声コマンドを使用する必要はありません。